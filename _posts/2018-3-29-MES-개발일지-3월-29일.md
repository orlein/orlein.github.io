---
layout: post
title: MES 개발일지 3월29일
categories: [Idea, PersonalLog]
---


MES 개발일지 3/29
------------------------


1. 시작단계

우리 회사와 같이 일하던 M사에서 이전 프로젝트를 위해 이미 예전에 해놓은 코드가 있었다. 당시의 기술 스택은...
 * DB: Oracle 11g
 * Backend: Spring Boot
 * Frontend: AngularJS
 * CI: 없음
 * VCS: SVN
 * 문서관리: 없음
 * taskrunner: 없음
 * test code: 없음

이었고 더 분석해보니 Scaffolder 'Jhipster'로 만들어 개조한 것이었다. node_modules 폴더는 plugin 폴더로 바뀌고, .gitignore파일은 있으나 제대로 관리를 해놓지 않았다. package.json폴더 역시 존재했으나 별 의미가 없었다. gulp파일도 반갑게도 있었으나 쓰지 않았다. 있는건 Java 소스뿐이었고, 관리는 전혀 이뤄지지 않았으며, 적절한 모듈화도 이뤄지지 않았다. 급한 소스 작성에만 급급한 프로젝트였다. 테스트는 모두 수동으로 해야했다.

2. 설계단계

설계는 많은 부분이 이미 되어있었다. 기준정보관리, 계획관리, 생산관리, 시스템관리 및 보고서와 대시보드 등 큰 틀과 구체적인 부분에서 90%정도는 이미 끝나있었다. DB설계와 ERP 인터페이스도 이미 이뤄져있었고 나에게 남은 것은 이것을 잘 trim하여 적용할 B사에 맞추는 것이라고 생각했다.

B사는 생각보다 명확하지 않은 생산계획과 작업프로세스를 진행하고있어 그에 대한 개선이 필요했다. 더욱이 자재의 사전인출이 아닌 사후인출방식을 택하고있어서 작업이 모두 끝난 다음에서야 투입된 자재들과 생산량을 체크했었다. 나는 MES를 시작할 당시 당연히 사전에 모든 자재의 인출이 끝난다고 생각했고, B사의 다른 협력업체의 조언을 듣고 원래 B사가 이렇게 작업을 진행하지 않았다고 생각을 수정할 수 있었다. 

설계단계에서 2달동안 1 주일에 한 번 씩 B사의 공장 소재지로 찾아가 작업 프로세스에 대해 파악하고, 질의응답을 이어갔다. 클라이언트로 좋은 분들을 만나 다행이었다. 어쩌면 귀찮을 수도 있었는데 많은 부분에서 성실히 답변해주셨고 지금도 굉장히 감사하게 생각한다. 자재관리, 생산관리, 출하관리 등 세세한 프로세스에 대해 답변을 들었고 결국 내 결론은 이렇다. "회사마다 MES를 똑같이 적용하려면, 애초에 표준화된 MES에 회사를 맞추라고 강요할 수 밖에 없다" 즉, 기존에 했던 설계는 전부 의미없는 짓이었다고 생각한다. 

요구사항을 정리하고, 스토리보드를 PowerPoint로 작성했다. 슬라이드마스터와 스토리보드 기능을 적절히 이용하였다. 큰 템플릿을 슬라이드마스터로 정하고 세세한 부분을 레이아웃으로 잡아 반복되는 화면을 Wireframing했다. 이것도 내가 하는작업이 뭔지 몰라 있는대로 검색해서 얻어낸 용어이다. 뭐 Storyboarding이라고도 불렀지만은, 틀린용어다.

그렇게 하여....

* 기준정보 관리
  * 작업장 기준정보
  * 품목 기준정보
  * 공정 기준정보
  * 설비 기준정보
  * 작업중지사유 기준정보
  * 공정부적합(불량) 기준정보
  * 협력사 기준정보
  * 바코드 기준정보
  * 금형 및 금형-품목 기준정보
* 시스템관리
  * 사내 사용자
  * 외주 사용자
  * 그룹 및 사용자-그룹
  * 메뉴 및 메뉴권한
  * 공통코드
* 생산관리
  * 생산계획, BOM, ROUTE 조회
  * 작업계획 수립 및 확정
* 작업관리
  * 관리자 작업관리
  * 작업자 작업관리
  * 작업자 제품관리
  * 작업자 검수관리
  * 작업자 설비관리
* 외주관리
  * 외주작업관리 (직납, 작업현황 관리)

라는 기준이 완성되었다. 여기에 빠진 것은....
* 보고서
* 알람
* 레시피 기준정보 및 관리
* 공정검사 기준정보 및 관리
* 수입검사 기준정보 및 관리
* 수출검사 기준정보 및 관리

등이다. 대체로 B사와 전혀 관계 없다고 생각한 것이 빠졌다.

3. 개발 단계

개발 단계에서 극복해야 할 것은 3가지였다. SVN, AngularJS, Spring이다. 이 3가지 모두 나에게는 legacy로 여겨졌다. 

특히 내가 제일 먼저 깨부순것은 SVN이다. git을 모르던 팀원들에게 git을 도입하기 위해 회사 서버(이마저도 거의 개인서버처럼 운영되던 서버)에 gitbucket을 깔았다. bitbucket을 할까 했지만 gitbucket이 당장에(1시간 안에) 서버를 열고 git repository를 열어놓기 좋았기 때문에 채택하였다. 팀원들에게 git add, commit, push, pull, merge 등을 가르쳤다. 나 역시 그렇게까지 git을 잘 알지는 못하지만 나도 공부하면서 가르쳤다. 결국 나도 잘 이해 못하는 branch에 대해 팀원들에게 이해시키는 것을 포기하고 svn처럼 git을 썼다. 뭐, 다음 프로젝트에서 잘 git을 쓰면 되겠지.

그러나 프로젝트의 기본적인 꼴이 나를 빡치게 했다. node_modules 폴더를 냅다 plugin 폴더로 고치고 그것을 "모두" 원격저장소에 올리는 형태였다. package.json에는 plugin 폴더에 있던 dependency들이 없어 사용할 수 없었다. 결국 git과 plugin폴더가 충돌을 일으켜 몇몇 폴더는 완전 수동으로 force add - commit - push를 해줘야했다. 아마 git을 쓰는 사람들 중 전세계에서 한두명 있을까 말까 한 바보짓이다. 

나는 AngularJS를 좋아했으나 몇번 들여다보고 너무나 학습곡선이 완만하여(=아무리 공부해도 이해가 되질 않아) 이제는 혐오한다. 느리다고 정평이 나있고, 회사로부터 강요되는 IDE인 eclipse는 AngularJS의 자동완성기능도 제대로 제공하지 않는다. 텍스트찾기를 할 수도 있다. 하지만... 가뜩이나 다른 것도 신경쓸 것이 많은데 프로젝트의 내용을 전부 다 머릿속에 넣고다녀야 한다는 점이 부담이 매우 컸다. C, C++, C#, Java, Python 등 내가 접해본 언어들처럼 import가 불가능하다는 것도 컸다. 심지어 같은 Angular도 JS를 뗀 버전 2.0부터는 typescript를 지원하여 명시적 require 또는 import가 가능하다. 그런데...아 말을 말자. 너무싫다. 그냥 하라는대로 틀에 따라서 개발하는 편이 속편하다. 프로젝트 구성이 '상식적으로' 이뤄졌다면 AngularJS에서도 ecmascript6를 적용해서 개발할 수도 있었을테지만...잊자. 잊어.

한 술 더 떠서 나는 Java와 Spring framework도 혐오한다. Spring framework가 bean, container처럼 훌륭한 아이디어를 가지고 있다는 것도 알고있고, 예전엔 이런 점을 정말로 공부하고 싶었다. 하지만 스스로 개발을 스스로 공부하면서 그딴거 없이도 잘 굴러가는 framework를 많이 알게되었고, spring같은 아이디어는 있지만 그걸 강요하지 않는 시스템도 많이 보았다. 왜 java와 spring을 쓰는가? Node.js나 RoR, Django, dotnetcore같은 엄청 편하고 간결하며 쉽기까지 한 것들에 비해 너무 장황하고 어렵다. 장점은 Java로 기작성된 legacy 코드를 지원한다는 점 딱 하나지만, 이번 프로젝트는 그런 legacy 코드에 의존하지 않는다. Spring이 완벽히 쓸모없어지는 프로젝트다.

------

개발을 진행하며 이 부분을 이어가겠다.